{% extends "base.html" %}

{% block title %}Import Virtual{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/virtual.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/import.css') }}">
{% endblock %}

{% block content %}
<div class="import-container">
    <!-- Import Type Selection -->
    <section class="import-section">
        <h2>
            <i class="fa-solid fa-filter"></i>
            Import Type
        </h2>
        <div class="import-type-selector">
            <label class="import-type-option">
                <input type="radio" name="importType" value="virtual" checked>
                <span class="option-content">
                    <i class="fa-solid fa-video"></i>
                    Virtual Events
                </span>
            </label>
            <label class="import-type-option">
                <input type="radio" name="importType" value="participants">
                <span class="option-content">
                    <i class="fa-solid fa-users"></i>
                    Participants
                </span>
            </label>
        </div>
    </section>

    <!-- Quick Sync Section -->
    <section class="import-section">
        <h2>
            <i class="fa-solid fa-sync"></i>
            Quick Sync
        </h2>
        <p>Sync virtual event data from the default CSV files in the data directory.</p>
        <button id="quickSyncBtn" class="sync-btn">
            <i class="fa-solid fa-bolt"></i>
            Quick Sync
        </button>
    </section>

    <!-- Manual Upload Section -->
    <section class="import-section">
        <h2>
            <i class="fa-solid fa-upload"></i>
            Manual Upload
        </h2>
        <p>Upload a CSV file containing virtual event or participant data.</p>
        
        <div id="uploadContainer" class="upload-container">
            <div class="upload-content">
                <i class="fa-solid fa-file-csv"></i>
                <p>Drop your CSV file here</p>
                <span>or</span>
                <label for="fileInput" class="upload-btn">Choose File</label>
                <input type="file" id="fileInput" accept=".csv" hidden>
            </div>
        </div>
    </section>

    <!-- Progress Section -->
    <section id="progressSection" class="import-section" style="display: none;">
        <h2>
            <i class="fa-solid fa-spinner fa-spin"></i>
            Import Progress
        </h2>
        <div class="progress-container">
            <div class="progress-bar">
                <div id="importProgress" class="progress" style="width: 0%"></div>
            </div>
            <div class="progress-stats">
                Processing... <span id="processedCount">0</span> records
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="import-section" style="display: none;">
        <h2>
            <i class="fa-solid fa-chart-bar"></i>
            Import Results
        </h2>
        <div class="results-stats">
            <div class="stat-card success">
                <i class="fa-solid fa-check-circle"></i>
                <span id="successCount" class="stat-count">0</span>
                <span class="stat-label">Successful</span>
            </div>
            <div class="stat-card warning">
                <i class="fa-solid fa-exclamation-circle"></i>
                <span id="warningCount" class="stat-count">0</span>
                <span class="stat-label">Warnings</span>
            </div>
            <div class="stat-card error">
                <i class="fa-solid fa-times-circle"></i>
                <span id="errorCount" class="stat-count">0</span>
                <span class="stat-label">Errors</span>
            </div>
        </div>
        <div id="errorList" class="error-list"></div>
    </section>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Add these variables before loading the JS file
    window.QUICK_SYNC_URL = "{{ url_for('virtual.quick_sync') }}";
    window.IMPORT_URL = "{{ url_for('virtual.import_virtual') }}";
</script>
<script src="{{ url_for('static', filename='js/virtual_import.js') }}"></script>
{% endblock %} 